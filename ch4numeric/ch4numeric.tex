
%----------------------------------------------------------------------------------------

\chapter{数值计算问题}
\section{数列通项公式和插值}
\subsection{数列通项公式}
我们经常碰到求数列中某一项的问题。本章我们将从数学的观点探讨一种求法，试图求出一些序列的通项公式，该方法对部分题目是有效的。
\begin{Exmpx}[数字填空]问号处应该填什么数字呢?\\
0    2    6     12     ?   30\\
0    6    24   60      ?  210
\end{Exmpx}

\begin{Exmpx}[常见数列] 更多一些数列：\\
0    2    4     6     8   $\cdots$ \\
2    3     5     7    11  $\cdots$ \\
1    4     9     16   25  $\cdots$ \\
0    1     1     2   3  $\cdots$ \\
0    1     3     6   10  $\cdots$
\end{Exmpx}

从数学的观点来看，数列可以视为一个关于时间的函数，$F(n),n=0,1,\cdots.$因此意味着只要找到这个函数了，我们就可以说找到数列的通项公式了（$F(n)$不一定是一个有解析表达式的函数）。函数的种类有很多，比如,上面的几个数列的函数如下：
\begin{Exmpx}[常见函数]
$n(n+1)$, $n(n+1)(n+2)$, $2n$,$prime(n)$第$n+1$个质数,$n^2$,$Fibonacci(n)$,$\sum_{i=0}^ni=\frac{n(n+1)}{2}$.
通常由于不知道函数的基本形式，我们只能靠观察。
\end{Exmpx}
\subsection{数列通项公式的基函数}
\subsection{插值}
插值实际上是在多项式空间寻找一个函数，满足已知数列的前$k+1$项$F(0),\cdots,F(k)$，也就是说
寻找一个不高于$k$次多项式
\begin{equation}
\label{eq:pn_x1_xn}
F(n)=a_kn^k+\cdots+a_1n+a_0
\end{equation}
使得前$k+1$项在以$n=0,1,2,\cdots,k$代入时，得到相应的$F(0),\cdots,F(k)$。

可以证明这个多项式是存在唯一的。

\begin{Exmpx}[平方和数列]
0 1 5 14 $\cdots$ \\
它的通项公式是$F(n)=\frac{n(n+1)(2n+1)}{6}$.
\end{Exmpx}

因为一个不高于$k$次多项式组成一个多项式的线性空间，这个空间是$k+1$维的，只要找出$n+1$个线性无关的多项式，那么就构成这个线性空间的一组基。
虽然解是同一个函数，根据基的不同，要待定的系数也不同，解法就不同。
\subsection{线性方程组求解插值}
取的基为$1,n,n^2,\cdots,n^k$，$F(n)$以式(\ref{eq:pn_x1_xn})的方式表出时，要求解$n+1$个参数$a_n,a_{n-1},\cdots,a_1,a_0$.
这里有$n+1$个参数$a_n,a_{n-1},\cdots,a_1,a_0$待定，正好可以连立得到$n+1$个方程组成的线性方程组。
因为方程的系数矩阵是范德蒙行列式，用克莱姆法则可以求解，但是克莱姆法则计算量太大。
所以不太适用，如果方程次数比较低，系数少，也可以手工求解。
\begin{Exmpx}[平方和数列]
0 1 5 14 $\cdots$ \\
总共四个点，设它的三次通项公式是$F(n)=a_3n^3+a_2n^2+a_1n+a_0$.
令$n=0,1,2,3$代入得到方程组
\begin{equation}
\nonumber
\left\{
\begin{array}{rcl}
  0 &=& a_0 \\
  1 &=& a_3+a_2+a_1+a_0 \\
  5 &=& 8a_3+4a_2+2a_1+a_0 \\
  14 &=& 27a_3+9a_2+3a_1+a_0 
\end{array}
\right.
\end{equation}
可以解得$a_3=\frac{1}{3},a_2=\frac{1}{2},a_1={1}{6},a_0=0$,也就是说
$F(n)=a_3n^3+a_2n^2+a_1n+a_0=\frac{1}{3}n^3+\frac{1}{2}n^2+\frac{1}{6}n=\frac{n(n+1)(2n+1)}{6}$
\end{Exmpx}

\subsection{牛顿插值法}
取另一组基$1,n,n(n-1),n(n-1)(n-2),\cdots,n(n-1)\cdots(n-k+1)$,则$F(n)$可以唯一表示成：
\begin{equation}
\label{eq:pn_1_n_n_1}
F(n)=b_01+b_1n+b_2n(n-1)+b_3n(n-1)(n-2)+\cdots+b_kn(n-1)\cdots(n-k+1)
\end{equation}
这里有$n+1$个参数$a_n,a_{n-1},\cdots,a_1,a_0$待定，正好可以连立得到$n+1$个方程组成。
但是这个方程比较简单地解决，$n=0$时，$F(0)=b_0$，可求得$b_0=F(0)$;
$n=1$时，$F(1)=b_0+b_11$，因$b_0$已求出，$b_1=F(1)-b_0$;
依次可求得$$b_j=\frac{F(j)-b_0-b_1j-b_2j(j-1)-\cdots-b_{j-1}j(j-1)\cdots 2}{j!}.$$
\begin{Exmpx}[平方和数列通项的牛顿插值解法]
设它的三次通项公式是$F(n)=b_01+b_1n+b_2n(n-1)+b_3n(n-1)(n-2)$.
令$n=0,1,2,3$代入得到方程组
\begin{equation}
\nonumber
\left\{
\begin{array}{rcl}
  0 &=& b_0 \\
  1 &=& b_0+b_1 \\
  5 &=& b_0+b_12+b_22 \\
 14 &=& b_0+b_13+b_26+b_36
\end{array}
\right.
\end{equation}
可以解得$b_0=0,b_1=1,b_2=\frac{3}{2},b_3=\frac{1}{3},$,也就是说
$F(n)=b_01+b_1n+b_2n(n-1)+b_3n(n-1)(n-2)=n+\frac{3}{2}n(n-1)+\frac{1}{3}n(n-1)(n-2)=\frac{n(n+1)(2n+1)}{6}$
\end{Exmpx}
\subsection{拉格朗日插值法}

\newpage

%-----------------------------------------------------------------------------------------
